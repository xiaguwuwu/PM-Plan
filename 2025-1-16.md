#  基于关联规则的电信网告警相关性分析

+++

## 数据预处理

数据预处理分为两步 ： 

* 第一步，是将告警数据转换成告警事务数据，这个问题是依据**滑动窗口方法**来解决的；

* 第二步，是为告警数据及告警事务数据分配权重 ，这个问题是通过**熵值法**来解决的。

### 基于聚类的滑动窗口事务提取方法

本文首先利用**DBSCAN算法**思想进行时间聚类将告警序列的时间区间划分成若干的时间段，每个时间段内利用均匀滑动时间窗方式提取告警事务，最后获得所有时间段内提取的事务数据集合，即为最终的告警事务数据集合。

### 基于熵值法确定权值

在告警数据中，告警的不同级别和影响大小应当具有不同的权重。告警权重反映了告警事件的相对重要性，通常这些权重是通过网络专家的经验来确定的。

目前，常用的告警权值计算方法包括层次分析法（AHP），它通过选择告警的不同属性，构建判断矩阵来进行权值计算。虽然这种方法使权值的确定更加科学，但当告警数据量非常大时，基于矩阵的计算方法会导致高计算消耗，影响整个关联规则挖掘的效率。

本文提出通过引入“熵值法”来将告警信息进行权值化，根据告警级别和设备节点拓扑结构来计算告警的权重。这种方法不仅能确保权重计算的科学性，还能显著减少计算时间，从而提高整个关联规则挖掘的效率

+++

## 改进的关联规则挖掘算法

关联规则挖掘是数据挖掘中的一个重要任务，它的目标是发现不同项之间的有趣关系。

<font color="red">针对带有权值的告警事务数据 </font>

提出了基于**Tidset数据压缩**和**WIT-树数据结构**的改进算法**WEclat**（垂直数据挖掘），从而提高关联规则挖掘的效率。

（发现频繁项并计算置信因子）

基于WIT-树的加权关联规则挖掘算法：处理拥有海量数据的告警事务数据库

在 WEclat 算法的基础上提出一种基于磁盘存储 1-项集 Tidset 的增量挖掘算法。该算法可以在原数据集增加、支持度发生变化或者两者都发生时，减小算法对数据库的扫描范围，提高频繁项集的挖掘效率。

+++

# Intrusion alert prioritisation and attack detection using post-correlation analysis（使用关联后分析进行入侵警报优先级和攻击检测）

+++

![image-20250114223519276](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20250114223519276.png)

本文介绍了一个名叫“ACSAnIA"系统

警报六元组：**警报的时间戳**、**源IP**、**源端口**、**目标IP**、**目标端口**、**入侵类型**

![image-20250114143639714](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20250114143639714.png)

警报关联图：表示警报与警报之间的先后关系以及关联程度

![image-20250114144320762](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20250114144320762.png)

ACSAnIA框架由七个组件组成：（1）离线关联（2）在线关联（3）元警报比较（4）元警报优先级排序（5）元警报聚类（6）攻击模式发现（7）报告系统

![image-20250114144629847](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20250114144629847.png)

## 离线关联

通过逐步先验方法生成约束

## 在线关联

比较警报之间是否相关

## 元警报比较

相关过程通常会产生多个元警报。在密集的流量分析下，短时间内可能会产生数百个元警报。为了理解生成的元警报，使用定量方法来衡量每个元警报之间的差异。这随后被用于元警报优先级和元警报聚类组件中。

## 元警报优先级排序

元警报优先级分配组件根据其与其他一组元警报的差异性为每个元警报分配一个优先级。有四个优先级，与其它元警报高度相似的元警报通常被赋予优先级1或2，而高度不同的元警报则被分配到级别3或4。

异常因子（LOF）算法评估元告警的异常程度

## 元警报聚类

通过聚类的方法将元警报进行分类**（DBSCAN算法）**

## 攻击模式发现

攻击模式发现组件接收聚类后的元告警，并尝试使用**频繁模式挖掘**来提取每个聚类的一组代表性特征。在模式挖掘之前，攻击模式发现组件将每个元告警表示为一个较简单的图结构，即模式图。攻击模式图是一个元告警的图表示形式，其中每个节点代表一个告警类型或告警类型的属性，每条边代表两个告警类型之间的相关性或属性与告警类型之间的关联关系。

# An Intrusion Action-Based IDS Alert Correlation Analysis and Prediction Framework（基于入侵操作的 IDS 告警关联分析和预测框架）

该文提出的**IACF框架**改进了警报聚合、动作提取和场景发现的过程，并应用了一种新的基于时间度量的入侵会话提取方法。该框架利用**内在强相关性**的概念对原始警报进行新的分组，而不是使用传统的窗口和超警报。为了发现高稳定的相关性，通过修剪算法去除会话中的冗余操作和操作链接模式，以减少误报的影响，最终构建一个基于这些修剪过的会话的关联图。基于关联图，提出了未来攻击的预测方法。

![image-20250114223410936](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20250114223410936.png)

## 提取阶段

在动作提取过程中，通过源IP地址和目标IP地址将警报分组。因此，在同一组中的警报是由一对IP地址之间的通信产生的。

![image-20250114205838448](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20250114205838448.png)

这两种情况产生的警报之间存在 **“内在相关性”**。换句话说，这些警报虽然分别触发，但它们实际上描述的是同一个入侵行为或攻击动作，它们是 **“不可分割的”**，也就是说，单独看待每个警报并不能完全描述攻击的全过程，必须将它们放在一起，才能全面理解整个入侵行为。

**我们可以对告警进行不同的分组：入侵动作基的分组方法。**假设一类攻击指令无论如何排序都会触发同一套告警。

警报对象被描述为**<时间，类型，源IP，源端口，目标IP，目标端口，协议>**

入侵动作对象可以定义为Action**<起始时间，结束时间，警报>**，其中字段警报是一个包含一组警报对象的序列；起始时间的值是从轨迹中第一个警报对象的时间字段派生出来的，而结束时间的值是从轨迹中的最后一个轨迹对象的时间字段派生出来的。

**规则**：基于数据观察，**dst-port**和**type**字段可以作为提取动作的组合约束。例如，如果两个具有相同dst-port或警报类型的警报在顺序中连续发生，则将它们分组为同一动作；否则，它们将被分为不同的动作。

**“警报集”**：基于一个或多个子集的重复构建各种警报序列的最小警报类型集合。例如，如果 X={a, b, b, a}，它的警报集可以表示为 |X| = {a, b}。动作的警报集与其警报序列不同，因为在警报集中不允许有重复元素。实际上，警报集包含代表动作的所有不重复元素的警报序列。 

对于两个动作X，Y，可以解释为相同入侵动作往往会触发相似类型的警报。由于相同类型警报的存在，两个动作被认为是相同的，而不是完全相等的警报序列。通过比较它们的**警报集**，可以匹配这些动作。 

## 建模阶段

### **入侵对话重建**

![image-20250114211221599](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20250114211221599.png)

作者提出了一种基于时间差的序列分割算法**TSS**，该算法可以确定一个会话的切割点。

### 侵入会话修剪

+++

提出了一种序列剪枝算法（简称SPA）。SPA的基本思想是迭代地删除序列的相邻重复模式。

![image](https://damo-moshicloud-test.oss-cn-hangzhou.aliyuncs.com/document/testcase/dingding/zhiwen_cases/1328798405576839168/1328798405576839168_cut_Table_1.png)

![image-20250114222046271](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20250114222046271.png)

### 侵入场景重建

+++

如果两个会话共享至少一个动作，则它们属于同一个场景，应该添加到相同的图中。构建相关图分为训练阶段和剪枝阶段。在可以离线执行的挖掘过程中进行的训练阶段，系统通过分析和关联历史数据来构造图。在线实施的修剪阶段是修改过程。

### 侵入检测

+++

在构建关联图的同时，收集每个二元相关性的频率以预测未来的攻击。在图 7 (d) 中，边旁边的数字表示二元相关的频率。

# A New Alert Correlation Model Based On  Similarity Approach（一种基于相似性方法的新型告警关联模型）

